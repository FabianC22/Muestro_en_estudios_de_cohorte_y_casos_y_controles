{"title":"Muestreo para estudios de cohorte y casos y controles","markdown":{"yaml":{"title":"Muestreo para estudios de cohorte y casos y controles","author":"Cesar Fabian Tiguaque Castellanos","format":"html","editor":"visual"},"headingText":"Contenido","headingAttr":{"id":"","classes":["scrollable"],"keyvalue":[]},"containsRefs":false,"markdown":"\n\n\n1.  Introducción\n\n2.  ¿ Que es el muestreo en estadística?\n\n3.  Tipo de muestreo\n\n4.  Muestreo en estudios de cohorte\n\n5.  Muestreo en estudios de casos y controles\n\n6.  Ejercicio en clase.\n\n## Introducción {.scrollable}\n\n<p align=\"justify\">\n\nLa importancia del muestreo en epidemiologia es fundamental, ya que permite estudiar poblaciones grandes, de tal manera que al realizar muestreo se puede asegurar estadisticamente este tendra las siguientes caracteristicas.\n\n-   Permite estudiar poblaciones grandes de forma eficiente\n\n-   Hace posible obtener estimaciones válidas y representativas\n\n-   Reduce sesgos\n\n-   Permite medir prevalencia e incidencia\n\n-   Ayuda en la vigilancia epidemiológica\n\n-   Optimiza recursos\n\n-   Permite generalizar los resultados\n\n-   Permite estimar la precisión (error y confianza)\n\nEn resumen el muestreo permite hacer estudios **eficientes, validos y con recursos limitados**\n\n</p>\n\n## ¿Que es el muestreo en estadística?\n\n<p align=\"justify\">\n\nEl muestreo en estadística es el proceso de seleccionar un grupo representativo de una población mas grande para analizarla y en algunos casos realizar inferencia sobre la población. La muestra debe ser finita, manejable y elegida preferentemente aleatoriamente para minimizar sesgos y garantizar fiabilidad en las estimaciones.\n\n</p>\n\n## Tipos de muestro {.scrollable}\n\n1.  Muestreo probabilístico: ( Marco muestral)\n\n    -   Muestreo aleatorio simple: Todos los individuos tienen la misma probabilidad de ser elegidos.\n\n    -   Muestreo sistemático: Se selecciona cada k individuo después de un punto inicial aleatorio.\n\n    -   Muestreo estratificado: Se divide la población en estratos homogéneos. despues se toma una muestra.\n\n    -   Muestreo por conglomerados: La población se divide en grupos (colegios, barrios, empresas, facultades.etc).\n\n    -   Muestreo multietápico: Combinación de varios tipos de muestreo.\n\n2.  Muestreo no probabilístico\n\n    -   Muestreo por conveniencia: Se elige lo disponible.\n\n    -   Muestreo dirigido: Selección de individuos con características específicas.\n\n    -   Muestreo por cuotas: Se fija cuántas personas se necesitan por grupo (edad, sexo, etc.), pero se selecciona de forma no aleatoria.\n\n    -   Muestreo bola de nieve: Un participante refiere a otros.\n\n# Muestreo en estudios de cohorte\n\n## Características del diseño en un estudio de cohortes {.smaller}\n\nEs un estudio observacional y longitudinal que investiga la presencia o ausencia de la exposición de interes, además la ocurrencia del evento se puede determinar de manera prospectiva o retrospectiva.\n\n![](figuras/C1.png){fig-align=\"center\" width=\"41.1cm\"}\n\n# Elección del tamaño muestral\n\n## Contexto para el cálculo de muestras\n\n1.  Si el objetivo es estimar el RR con una precisión relativa especificada.\n2.  Si el objetivo es probar que el RR es estadísticamente diferente de 1.\n3.  Si el objetivo es comparar dos tasas de incidencia.\n\n## Estimar el riesgo relativo con una precisión relativa especificada {.scrollable}\n\na.  Dos de las siguientes proposiciones:\n\n-   Probabilidad anticipada de enfermar en personas expuestas al factor de interés: $P_1$\n\n-   Probabilidad anticipada de enfermar en personas no expuestas al factor de interés: $P_2$\n\n-   Riesgo Relativo anticipado: $RR=P_1 / P_2$\n\nb.  Nivel de confianza: 100(1-α)%\n\nc.  Precisión relativa: ε\n\nSi cumple con lo anterior se puede calcular el tamaño de muestra n.\n\n$$\nn = \\frac{Z_{1-\\alpha/2}^2 \\left[ \\frac{1-P_1}{P_1} + \\frac{1-P_2}{P_2} \\right]}\n{\\ln^2 (1-\\varepsilon)}\n$$\n\n## Aplicación {.scrollable}\n\n::: panel-tabset\n### Ejemplo {.smaller}\n\nSupongamos que queremos estudiar la posible asociación de un factor ambiental en la incidencia de una enfermedad respiratoria específica, si deseamos una precisión del $10 \\%$, tenemos dos poblaciones semejantes una no expuesta con $P_2 = 0.2$ y una expuesta con $P_1 = 0.4$\n\n```{r}\n#| echo: true\nalpha <- 0.05\nP1 <- 0.5\nP2 <- 0.1\nepsilon <- 0.05\n\nn <- (qnorm(1 - alpha/2)^2 * ((1 - P1)/P1 + (1 - P2)/P2)) / (log(1 - epsilon)^2)\nn\n\n```\n\nSe obtiene $1903.28$ para cada grupo.\n\n### Simulación de parámetros {.smaller}\n\nSe realiza la simulación de parámetros donde $\\alpha$ y $\\varepsilon$ son fijos, y $P_1$ y $P_2$ son variables.\n\n```{r, echo=FALSE,warning=TRUE}\n#|echo: false\nlibrary(plotly)\n\ncalc_n <- function(P1, P2, alpha, epsilon) {\n  n <- (qnorm(1 - alpha/2)^2 * ((1 - P1)/P1 + (1 - P2)/P2)) / (log(1 - epsilon)^2)\n return(n)\n}\n\n\ngrafico<-function(alpha,epsilon) {\n  \n# --- RANGOS VARIABLES ---\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\n# --- MATRIZ DE RESULTADOS ---\nz_matrix <- outer(P1_vals, P2_vals,\n                  Vectorize(function(a, b) calc_n(a, b, alpha, epsilon)))\n\n# --- GRAFICO 3D ---\np1<-plot_ly(\n  x = P1_vals,\n  y = P2_vals,\n  z = z_matrix,\n  type = \"surface\",\n  colorscale = \"Viridis\"\n) %>%\n  layout(\n    title = paste(\"P1 vs P2 para epsilon=\",epsilon,\"y alpha=\",alpha),\n    scene = list(\n      xaxis = list(title = \"P1\"),\n      yaxis = list(title = \"P2\"),\n      zaxis = list(title = \"n\")\n    )\n  )\n\nreturn(p1)\n}\n\n```\n\n-   Para $\\alpha=0.05$ y $\\varepsilon=0.1$\n\n```{r, echo=FALSE}\n#|echo: false\n# --- PARAMETROS FIJOS ---\nalpha <- 0.05\nepsilon <- 0.1\n\ngrafico(alpha,epsilon)\n\n```\n\n-   Para $\\alpha=0.05$ y $\\varepsilon=0.3$\n\n```{r, echo=FALSE}\n#|echo: false\n# --- PARAMETROS FIJOS ---\nalpha <- 0.05\nepsilon <- 0.3\n\ngrafico(alpha,epsilon)\n\n```\n\n-   Para $\\alpha=0.05$ y $\\varepsilon=0.6$\n\n```{r, echo=FALSE}\n#|echo: false\n# --- PARAMETROS FIJOS ---\nalpha <- 0.05\nepsilon <- 0.6\n\ngrafico(alpha,epsilon)\n\n```\n\n-   Para $\\alpha=0.05$ y $\\varepsilon=0.9$\n\n```{r, echo=FALSE}\n#|echo: false\n# --- PARAMETROS FIJOS ---\nalpha <- 0.05\nepsilon <- 0.9\n\ngrafico(alpha,epsilon)\n\n```\n:::\n\n## Probar que el RR es estadísticamente diferente de 1 {.scrollable}\n\na.  Prueba de hipótesis: $H_o : RR = 1$ vs $H_a : RR ≠ 1$\n\nb.  Dos de las siguientes propsiciones:\n\n-   Probabilidad anticipada de enfermar en personas expuestas al factor de interés: $P_1$\n\n-   Probabilidad anticipada de enfermar en personas no expuestas al factor de interés: $P_2$\n\n-   Riesgo Relativo anticipado: $RR=P_1 / P_2$\n\nc.  Nivel de confianza: $100(1 − α)\\%$\n\nd.  Potencia del test: $100(1 − β)\\%$\n\ne.  Cantidad de no expuestos por cada expuesto: r\n\nSi cumple con lo anterior se puede calcular el tamaño de muestra n.\n\nSe utiliza la siguiente expresión:\n\n$$\nn' = \\frac{\\left[ Z_{1-\\alpha/2} \\sqrt{(r+1)P_M(1-P_M)} - Z_{1-\\beta} \\sqrt{rP_1(1-P_1) + P_2(1-P_2)} \\right]^2}{r(P_1 - P_2)^2}\n$$\n\ndonde:\n\n$$\nP_M = \\frac{(P_1 + rP_2)}{(r+1)}\n$$\n\nAsimismo, la mayoría de software estadístico, como EpiDat, propone la corrección de Yates para el cálculo del tamaño muestral:\n\n$$\nn = \\frac{n'}{4} \\left[ 1 + \\sqrt{1 + \\frac{2(r+1)}{n' r \\left| P_2 - P_1 \\right|}} \\right]^2\n$$\n\n## Aplicación {.scrollable}\n\n::: panel-tabset\n### Ejemplo {.smaller}\n\nCalcular el tamaño de muestra suponiendo que $P_1 = 0.2$ y $P_2 = 0.1$, $α = 0.05$, $β = 0.2$ y $r = 1$ (un no expuesto por cada expuesto)\n\n```{r}\n#| echo: true\n\ncalc_muestra <- function(P1, P2, r, alpha, power){\n\n  # Z's\n  Za <- qnorm(1 - alpha/2)\n  Zb <- qnorm(1-power)   \n\n  # P_M\n  PM <- (P1 + r*P2) / (r + 1)\n\n  # n'\n  n_prime <- (\n    Za*sqrt((r+1)*PM*(1-PM)) -\n      Zb*sqrt(r*P1*(1-P1) + P2*(1-P2))\n  )^2 / ( r*(P1 - P2)^2 )\n\n  # Corrección de Yates\n  n_yates <- (n_prime/4) *\n    ( 1 + sqrt(1 + 2*(r+1)/(n_prime*r*abs(P2-P1))) )^2\n\n  return( n_yates)\n}\n\n\nres <- calc_muestra(\n  P1 = 0.2,\n  P2 = 0.1,\n  r = 1,\n  alpha = 0.05,\n  power = 0.80\n)\n\nres\n```\n\nEntonces el tamaño de muestra calculado es $n = 219$ en ambos grupos por la correción de yates.\n\n### Simulación de parámetros {.smaller}\n\nSe realiza la simulación de parámetros donde $\\alpha$, $power$ y $r$ son fijos, y $P_1$ y $P_2$ son variables.\n\n```{r, echo=FALSE}\n#|echo: false\n\ngrafico2<-function(r,alpha,power) {\n\n# Secuencias para P1 y P2\nP1_seq <-  seq(0.05, 0.98, by = 0.05)\nP2_seq <-  seq(0.05, 0.98, by = 0.05)\n\n# Crear todas las combinaciones P1-P2\ngrid <- expand.grid(P1 = P1_seq, P2 = P2_seq)\n\n# Eliminar combinaciones donde P1 = P2\ngrid <- subset(grid, P1 != P2)\n\n# Calcular muestra para cada combinación\ngrid$n <- mapply(\n  calc_muestra,\n  P1 = grid$P1,\n  P2 = grid$P2,\n  MoreArgs = list(r = r, alpha = alpha, power = power)\n)\n\n\n\n#  Heatmap\np2<-ggplot(grid, aes(x = P1, y = P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"viridis\") +\n  labs(\n    title = paste(\"P1 vs P2 para r=\",r,\", alpha=\",alpha,\"y power=\",power),\n    x = \"P1\",\n    y = \"P2\",\n    fill = \"n\"\n  ) +\n  theme_minimal(base_size = 14)\n\nreturn(p2)\n  \n}\n\n\n```\n\n-   Para $\\alpha=0.05$,$power=0.8$ y $r=1$\n\n```{r, echo=FALSE}\n#|echo: false\n\n# Valores fijos\nr     <- 1\nalpha <- 0.05\npower <- 0.80\n\ngrafico2(r,alpha,power)\n\n```\n\n-   Para $\\alpha=0.05$,$power=0.8$ y $r=2$\n\n```{r, echo=FALSE}\n#|echo: false\n\n# Valores fijos\nr     <- 2\nalpha <- 0.05\npower <- 0.80\n\ngrafico2(r,alpha,power)\n\n```\n\n-   Para $\\alpha=0.05$,$power=0.8$ y $r=3$\n\n```{r, echo=FALSE}\n#|echo: false\n\n# Valores fijos\nr     <- 3\nalpha <- 0.05\npower <- 0.80\n\ngrafico2(r,alpha,power)\n\n```\n\n-   Para $\\alpha=0.05$,$power=0.8$ y $r=4$\n\n```{r, echo=FALSE}\n#|echo: false\n\n# Valores fijos\nr     <- 4\nalpha <- 0.05\npower <- 0.80\n\ngrafico2(r,alpha,power)\n\n```\n\n-   Para $\\alpha=0.05$,$power=0.8$ y $r=5$\n\n```{r, echo=FALSE}\n#|echo: false\n\n# Valores fijos\nr     <- 5\nalpha <- 0.05\npower <- 0.80\n\ngrafico2(r,alpha,power)\n\n```\n:::\n\n## Comparar dos tasas de incidencia {.scrollable}\n\na.  Hipótesis nula H₀: μ₁ - μ₂ = 0\n\nb.  Valores anticipados de μ₁ y μ₂\n\nc.  Nivel de confianza: 100(1−α)%\n\nd.  Potencia del test: 100(1−β)%\n\ne.  Hipótesis alternativa H₁:\n\n    -   μ₁ − μ₂ \\< 0\\\n    -   μ₁ − μ₂ \\> 0\\\n    -   μ₁ − μ₂ ≠ 0\n\nf.  Duración del estudio: T\n\nBajo este contexto se aplican las siguientes expresiones.\n\n-   Si el estudio no tiene duración fija (o sea los sujetos se siguen durante toda su vida) se utiliza la siguiente fórmula:\n\n    **Para pruebas de una cola:**\n\n    $$n_1 = \\frac{\\left[z_{1-\\alpha}\\sqrt{(1+k)\\mu_m^2} + z_{1-\\beta}\\sqrt{k\\mu_1^2 + \\mu_2^2}\\right]^2}{k(\\mu_1 - \\mu_2)^2}$$\n\n    donde $\\mu_m = (\\mu_1 + \\mu_2)/2$ y $k$ es el cociente de la cantidad de individuos del segundo grupo ($n_2$) entre la cantidad del primer grupo ($n_1$).\n\n    **Para pruebas de dos colas:**\n\n    $$n_1 = \\frac{\\left[z_{1-\\alpha/2}\\sqrt{(1+k)\\mu_m^2} + z_{1-\\beta}\\sqrt{k\\mu_1^2 + \\mu_2^2}\\right]^2}{k(\\mu_1 - \\mu_2)^2}$$\n\n-   Si el estudio termina antes que todos los individuos experimenten el suceso de interés. Los valores de μ deben modificarse de acuerdo a la siguiente fórmula:\n\n    $$f(\\mu) = \\frac{\\mu^3 T}{\\mu T - 1 + \\exp(-\\mu T)}$$\n\n    Notemos que cuando $T$ tiende a infinito entonces $f(\\mu) = \\mu^2$.\n\n    La fórmula apropiada para el tamaño de muestra en pruebas de dos colas es:\n\n    $$n_1 = \\frac{\\left[z_{1-\\alpha/2}\\sqrt{(1+k)f(\\mu_m)} + z_{1-\\beta}\\sqrt{kf(\\mu_1) + f(\\mu_2)}\\right]^2}{k(\\mu_1 - \\mu_2)^2}$$\n\n## Aplicación {.scrollable}\n\n::: panel-tabset\n### Ejemplo {.smaller}\n\nComo parte de un estudio de los efectos a largo plazo del ruido, se diseña un estudio de seguimiento de trabajadores de una industria ruidosa y de una ocupación menos ruidosa. Los sujetos serán seguidos de por vida, y periódicamente serán examinados en cuanto a disfunciones auditivas. Una encuesta previa sugiere una tasa de incidencia anual del 25% en dicha industria. ¿Cuántas personas se deberán seguir si queremos saber que esta tasa difiere del promedio nacional de disfunciones auditivas = 10%, con un nivel de significación del 5% y una potencia del 80%?\n\n```{r}\n#| echo: true\n# Parámetros\nmu1  <- 0.25\nmu2  <- 0.10\nalpha <- 0.05\nbeta  <- 0.20\n\n# k = n2 / n1  (modifícalo según tu diseño)\nk <- 1   #  n2 = n1\n\n# Cuantiles Z\nz_alpha_2 <- qnorm(1 - alpha/2) \nz_beta    <- qnorm(1 - beta)      \n\n\nmu_m <- (mu1 + mu2) / 2\n\n# Términos de la fórmula\nterm1 <- z_alpha_2 * sqrt((1 + k) * mu_m^2)\nterm2 <- z_beta    * sqrt(k * mu1^2 + mu2^2)\n\n# Fórmula final\nn1 <- (term1 + term2)^2 / (k * (mu1 - mu2)^2)\n\n\n# Resultados\ncat(\"n1 =\", n1, \"\\n\")\n\n\n```\n\nSe tiene que para cada grupo se requeririan 23 personas.\n\nAhora si consideramos que la duración del estudio es de 5 años,tenemos los siguiente.\n\n```{r}\n#| echo: true\n\nt<-5\n\nfu_m<- (mu_m^3 * t)/(mu_m*t-1+exp(-mu_m*t))\n\nfu_1<- (mu1^3 * t)/(mu1*t-1+exp(-mu1*t))\nfu_2<- (mu2^3 * t)/(mu2*t-1+exp(-mu2*t))\n\n# Términos de la fórmula\ntermf1 <- z_alpha_2 * sqrt((1 + k) *fu_m )\ntermf2 <- z_beta    * sqrt(k * fu_1+ fu_2)\n\n# Fórmula final\nnf1 <- (termf1 + termf2)^2 / (k * (mu1 - mu2)^2)\nnf1\n\n\n```\n\nSe tiene que para cada grupo se requeririan 65 personas.\n\n### Simulación caso seguimiento de por vida {.smaller}\n\n-   Si $n_2=n_1$ es decir $k=1$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n1 <- function(mu1, mu2) {\n  alpha <- 0.05\n  beta  <- 0.20\n  k     <- 1\n  \n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n  \n  mu_m <- (mu1 + mu2) / 2\n  \n  term1 <- z_alpha_2 * sqrt((1 + k) * mu_m^2)\n  term2 <- z_beta    * sqrt(k * mu1^2 + mu2^2)\n  \n  n1 <- (term1 + term2)^2 / (k * (mu1 - mu2)^2)\n  return(n1)\n}\n\n\n  \nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n\ngrid$n1 <- mapply(calc_n1, grid$mu1, grid$mu2)\n\n\n\nggplot(grid, aes(x = mu1, y = mu2, fill = n1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"viridis\") +\n  labs(\n    title = \"Tamaño muestral n1 donde k=1\",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"n1\"\n  ) +\n  theme_minimal(base_size = 14)\n\n\n```\n\n-   Si $n_2>n_1$ es decir $k>1$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n1 <- function(mu1, mu2) {\n  alpha <- 0.05\n  beta  <- 0.20\n  k     <- 3\n  \n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n  \n  mu_m <- (mu1 + mu2) / 2\n  \n  term1 <- z_alpha_2 * sqrt((1 + k) * mu_m^2)\n  term2 <- z_beta    * sqrt(k * mu1^2 + mu2^2)\n  \n  n1 <- (term1 + term2)^2 / (k * (mu1 - mu2)^2)\n  return(n1)\n}\n\n\n  \nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n\ngrid$n1 <- mapply(calc_n1, grid$mu1, grid$mu2)\n\n\n\nggplot(grid, aes(x = mu1, y = mu2, fill = n1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"viridis\") +\n  labs(\n    title = \"Tamaño muestral n1 donde k=3\",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"n1\"\n  ) +\n  theme_minimal(base_size = 14)\n\n\n```\n\n-   Si $n_2<n_1$ es decir $k<1$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n1 <- function(mu1, mu2) {\n  alpha <- 0.05\n  beta  <- 0.20\n  k     <- 0.1\n  \n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n  \n  mu_m <- (mu1 + mu2) / 2\n  \n  term1 <- z_alpha_2 * sqrt((1 + k) * mu_m^2)\n  term2 <- z_beta    * sqrt(k * mu1^2 + mu2^2)\n  \n  n1 <- (term1 + term2)^2 / (k * (mu1 - mu2)^2)\n  return(n1)\n}\n\n\n  \nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n\ngrid$n1 <- mapply(calc_n1, grid$mu1, grid$mu2)\n\n\n\nggplot(grid, aes(x = mu1, y = mu2, fill = n1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"viridis\") +\n  labs(\n    title = \"Tamaño muestral n1 donde k=0.1\",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"n1\"\n  ) +\n  theme_minimal(base_size = 14)\n\n\n```\n\n### Simulación caso T {.smaller}\n\n-   Si $t=5$ y $k=1$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_nf1 <- function(mu1, mu2){\n\n  # Parámetros fijos\n  alpha <- 0.05\n  beta  <- 0.20\n  t     <- 5\n  k     <- 1\n\n  # Cuantiles\n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n\n  # mu_m\n  mu_m <- (mu1 + mu2) / 2\n\n  # Funciones fu\n  fu_m <- (mu_m^3 * t) / (mu_m * t - 1 + exp(-mu_m * t))\n  fu_1 <- (mu1^3 * t) / (mu1 * t - 1 + exp(-mu1 * t))\n  fu_2 <- (mu2^3 * t) / (mu2 * t - 1 + exp(-mu2 * t))\n\n  # Términos\n  termf1 <- z_alpha_2 * sqrt((1 + k) * fu_m)\n  termf2 <- z_beta    * sqrt(k * fu_1 + fu_2)\n\n  # Fórmula final\n  nf1 <- (termf1 + termf2)^2 / (k * (mu1 - mu2)^2)\n\n  return(nf1)\n}\n\n\n# -----------------------------------------\n# Crear rejilla de valores mu1 y mu2\n# -----------------------------------------\nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n# Evitar combinación inválida mu1 == mu2\ngrid <- subset(grid, mu1 != mu2)\n\n# Calcular valores nf1\ngrid$nf1 <- mapply(calc_nf1, grid$mu1, grid$mu2)\n\n\n# -----------------------------------------\n# Heatmap con ggplot2\n# -----------------------------------------\nlibrary(ggplot2)\n\nggplot(grid, aes(x = mu1, y = mu2, fill = nf1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"plasma\", trans = \"log\", breaks = c(10, 100, 1000, 5000)) +\n  labs(\n    title = \"Tamaño muestral para t=5 y k=1 \",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"nf1\"\n  ) +\n  theme_minimal(base_size = 14) + \n  theme(\n    plot.title = element_text(face = \"bold\", size = 18),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n\n```\n\n-   Si $t=5$ y $k=3$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_nf1 <- function(mu1, mu2){\n\n  # Parámetros fijos\n  alpha <- 0.05\n  beta  <- 0.20\n  t     <- 5\n  k     <- 3\n\n  # Cuantiles\n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n\n  # mu_m\n  mu_m <- (mu1 + mu2) / 2\n\n  # Funciones fu\n  fu_m <- (mu_m^3 * t) / (mu_m * t - 1 + exp(-mu_m * t))\n  fu_1 <- (mu1^3 * t) / (mu1 * t - 1 + exp(-mu1 * t))\n  fu_2 <- (mu2^3 * t) / (mu2 * t - 1 + exp(-mu2 * t))\n\n  # Términos\n  termf1 <- z_alpha_2 * sqrt((1 + k) * fu_m)\n  termf2 <- z_beta    * sqrt(k * fu_1 + fu_2)\n\n  # Fórmula final\n  nf1 <- (termf1 + termf2)^2 / (k * (mu1 - mu2)^2)\n\n  return(nf1)\n}\n\n\n# -----------------------------------------\n# Crear rejilla de valores mu1 y mu2\n# -----------------------------------------\nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n# Evitar combinación inválida mu1 == mu2\ngrid <- subset(grid, mu1 != mu2)\n\n# Calcular valores nf1\ngrid$nf1 <- mapply(calc_nf1, grid$mu1, grid$mu2)\n\n\n# -----------------------------------------\n# Heatmap con ggplot2\n# -----------------------------------------\nlibrary(ggplot2)\n\nggplot(grid, aes(x = mu1, y = mu2, fill = nf1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"plasma\", trans = \"log\", breaks = c(10, 100, 1000, 5000)) +\n  labs(\n    title = \"Tamaño muestral para t=5 y k=3 \",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"nf1\"\n  ) +\n  theme_minimal(base_size = 14) + \n  theme(\n    plot.title = element_text(face = \"bold\", size = 18),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n\n```\n\n-   Si $t=5$ y $k=0.1$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_nf1 <- function(mu1, mu2){\n\n  # Parámetros fijos\n  alpha <- 0.05\n  beta  <- 0.20\n  t     <- 5\n  k     <- 0.1\n\n  # Cuantiles\n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n\n  # mu_m\n  mu_m <- (mu1 + mu2) / 2\n\n  # Funciones fu\n  fu_m <- (mu_m^3 * t) / (mu_m * t - 1 + exp(-mu_m * t))\n  fu_1 <- (mu1^3 * t) / (mu1 * t - 1 + exp(-mu1 * t))\n  fu_2 <- (mu2^3 * t) / (mu2 * t - 1 + exp(-mu2 * t))\n\n  # Términos\n  termf1 <- z_alpha_2 * sqrt((1 + k) * fu_m)\n  termf2 <- z_beta    * sqrt(k * fu_1 + fu_2)\n\n  # Fórmula final\n  nf1 <- (termf1 + termf2)^2 / (k * (mu1 - mu2)^2)\n\n  return(nf1)\n}\n\n\n# -----------------------------------------\n# Crear rejilla de valores mu1 y mu2\n# -----------------------------------------\nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n# Evitar combinación inválida mu1 == mu2\ngrid <- subset(grid, mu1 != mu2)\n\n# Calcular valores nf1\ngrid$nf1 <- mapply(calc_nf1, grid$mu1, grid$mu2)\n\n\n\nlibrary(ggplot2)\n\nggplot(grid, aes(x = mu1, y = mu2, fill = nf1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"plasma\", trans = \"log\", breaks = c(10, 100, 1000, 5000)) +\n  labs(\n    title = \"Tamaño muestral para t=5 y k=0.1 \",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"nf1\"\n  ) +\n  theme_minimal(base_size = 14) + \n  theme(\n    plot.title = element_text(face = \"bold\", size = 18),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n\n```\n:::\n\n## Cuándo usar cada tipo de cálculo de tamaño de muestra {.scrollable}\n\n1.  Estimar el RR con una precisión relativa especificada,basicamente estimar un riesgo relativo (RR) y que el intervalo de confianza tenga una precisión predeterminada.\n\n-   Estudios donde ya se sabe que existe asociación, entonces se quiere una medición precisa.\n-   Estudios de cohorte prospectivos que buscan describir la magnitud del riesgo.\n\n2.  Probar que el RR es estadísticamente diferente de 1. Se busca demostrar una diferencia real\n\n-   Evaluar si un medicamento incrementa o reduce el riesgo de un desenlace.\n-   Estudios prospectivos en ocupacional donde se quiere probar si una exposición es peligrosa.\n\n3.  Comparar dos tasas de incidencia.\n\n-   Investigaciones sobre enfermedades crónicas con períodos largos.\n-   Estudios donde el desenlace es raro, pero se acumula persona-tiempo.\n\n# Muestreo en estudios de casos y controles\n\n## Características del diseño de casos y controles {.smaller}\n\nLos estudios de casos y controles son diseños observacionales, analíticos y retrospectivos.\n\n![](figuras/CC1.png){fig-align=\"center\"}\n\n# Elección del tamaño muestral\n\n## Contexto para el cálculo de muestras\n\n1.  Estimar la Razón de Odds (OR) con una precisión relativa especificada.\n\n2.  Probar que la Razón de Odds (OR) difiere significativamente de 1.\n\n## Estimar la Razón de Odds (OR) con una precisión relativa especificada {.scrollable}\n\nSe debe tener lo siguiente:\n\na.  Dos de los siguientes elementos:\n\n-   **Probabilidad anticipada de la exposición al factor en individuos enfermos:**\\\n    $P_1 = \\frac{a}{a + b}$\n\n-   **Probabilidad anticipada de la exposición en individuos sanos:**\\\n    $P_2 = \\frac{c}{c + d}$\n\n-   **Razón de Odds anticipado:**\\\n    $OR=\\frac{P_1/(1-P_1)}{P_2/(1-P_2)}$\n\nb.  Nivel de confianza: $100(1-\\alpha)\\%$\n\nc.  Precisión relativa: $\\varepsilon$\n\nSe utiliza en este caso la siguiente fórmula para obtener el tamaño muestral:\n\n$$\nn = Z_{1-\\alpha/2}^2 \\, \\frac{ \\frac{1}{P_1(1-P_1)} + \\frac{1}{P_2(1-P_2)} }{ \\ln^2(1-\\varepsilon) }\n$$\n\n## Aplicación {.scrollable}\n\n::: panel-tabset\n### Ejemplo {.smaller}\n\nEn una región donde el cólera es un problema grave de salud, se supone que el 30% de la población utilizan agua contaminada. Se desea realizar un estudio para estimar el OR con una precisión relativa del 25% (OR anticipado igual a 2) con un 95% de confianza. ¿Cuál es el tamaño de la muestra en los casos de cólera y en los controles?\n\nTenemos que $P_2 = 0.3$, $OR = 2$,$\\varepsilon = 0.25$ y $\\alpha = 0.05$.\n\nCalculamos primero $P_1$ mediante:\n\n$$\nP_1 = \\frac{P_2}{(1 - P_2)/OR + P_2}\n     = \\frac{0.3}{0.7/2 + 0.3}\n     \\approx 0.46\n$$\n\n```{r}\n#| echo: true\nn <- function(P1, P2, alpha, eps){\n\n  Za <- qnorm(1 - alpha/2)\n\n  n <- Za^2 * ( 1/(P1*(1-P1)) + 1/(P2*(1-P2)) ) / ( log(1 - eps)^2 )\n\n  return(n)\n}\n\nn(P1 = 0.18, P2 = 0.1, alpha = 0.05, eps =0.05 )\n```\n\n### Simulación {.smaller}\n\n-   Para una precisión relativa de $10 \\%$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n <- function(P1, P2, alpha, eps){\n\n  Za <- qnorm(1 - alpha/2)\n\n  n <- Za^2 * ( 1/(P1*(1-P1)) + 1/(P2*(1-P2)) ) /\n       ( log(1 - eps)^2 )\n\n  return(n)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\n\nalpha <- 0.05\neps   <- 0.10\n\ngrid$n <- calc_n(grid$P1, grid$P2, alpha, eps)\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Tamaño de muestra precisión relativa de 10 %\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n\n-   Para una precisión relativa de $30 \\%$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n <- function(P1, P2, alpha, eps){\n\n  Za <- qnorm(1 - alpha/2)\n\n  n <- Za^2 * ( 1/(P1*(1-P1)) + 1/(P2*(1-P2)) ) /\n       ( log(1 - eps)^2 )\n\n  return(n)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\n\nalpha <- 0.05\neps   <- 0.30\n\ngrid$n <- calc_n(grid$P1, grid$P2, alpha, eps)\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Tamaño de muestra precisión relativa de 30 %\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n\n-   Para una precisión relativa de $60 \\%$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n <- function(P1, P2, alpha, eps){\n\n  Za <- qnorm(1 - alpha/2)\n\n  n <- Za^2 * ( 1/(P1*(1-P1)) + 1/(P2*(1-P2)) ) /\n       ( log(1 - eps)^2 )\n\n  return(n)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\n\nalpha <- 0.05\neps   <- 0.60\n\ngrid$n <- calc_n(grid$P1, grid$P2, alpha, eps)\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Tamaño de muestra precisión relativa de 60 %\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n:::\n\n## Probar que la Razón de Odds (OR) difiere significativamente de 1 {.scrollable}\n\na.  Hipótesis nula: **H₀:** $OR = 1$\n\nb.  Dos de los siguientes elementos:\n\n-   Probabilidad anticipada de la exposición al factor en individuos enfermos $P_1$\n-   Probabilidad anticipada de la exposición en individuos sanos $P_2$\n-   Razón de Odds anticipado $OR_a$\n\nc.  Nivel de confianza: $100(1-\\alpha)\\%$\n\nd.  Potencia del test: $100(1-\\beta)\\%$\n\ne.  Hipótesis alternativa: **Hₐ:** $OR_a \\ne 1$\n\nSe utiliza en este caso la siguiente fórmula:\n\n$$\nn' =\n\\frac{\n\\left[\nZ_{1-\\alpha/2}\\,\\sqrt{(r+1)P_M(1-P_M)}\n\\;-\\;\nZ_{1-\\beta}\\,\\sqrt{rP_1(1-P_1) + P_2(1-P_2)}\n\\right]^2\n}{\nr(P_1 - P_2)^2\n}\n$$\n\ndonde:\n\n$$\nP_M = \\frac{P_1 + rP_2}{r + 1}\n$$\n\nCon la *corrección de Yates* para el cálculo del tamaño muestral:\n\n$$\nn = \n\\frac{n'}{4}\n\\left[\n1\n+\n\\sqrt{\n1 + \n\\frac{2(r+1)}{\nn'r\\,|P_2 - P_1|\n}\n}\n\\right]^2\n$$\n\n## Aplicación {.scrollable}\n\n::: panel-tabset\n### Ejemplo {.smaller}\n\nCalcular del tamaño muestral suponiendo que \\$P2 = 0.1 \\$y $OR = 2.0$, $α = 0.05$, $β = 0.8$ y $r = 1$ (un control por cada caso).\n\n```{r}\n#| echo: true\n\ncalc_nprime <- function(P1, P2, r, alpha, beta){\n\n  # Z de alfa y beta\n  Za <- qnorm(1 - alpha/2)\n  Zb <- qnorm(1 - beta)\n\n  # P_M\n  PM <- (P1 + r*P2) / (r + 1)\n\n  # n'\n  nprime <- (\n    (Za * sqrt((r + 1) * PM * (1 - PM)) -\n       Zb * sqrt(r * P1 * (1 - P1) + P2 * (1 - P2))\n    )^2\n  ) /\n    ( r * (P1 - P2)^2 )\n\n  return(nprime)\n}\n\n\ncalc_n_yates <- function(nprime, P1, P2, r){\n\n  n <- (nprime / 4) *\n    ( 1 + sqrt(1 + (2 * (r + 1)) / (nprime * r * abs(P2 - P1))) )^2\n\n  return(n)\n}\n\ncalc_n_full <- function(P1, P2, r, alpha, beta){\n\n  nprime <- calc_nprime(P1, P2, r, alpha, beta)\n  n_yates <- calc_n_yates(nprime, P1, P2, r)\n\n  return(list(nprime = nprime, n_yates = n_yates))\n}\n\ncalc_n_full(P1 = 0.1818, P2 = 0.1, r = 1, alpha = 0.05, beta = 0.80)\n\n```\n\n### Simulación {.smaller}\n\n-   Un control por cada caso.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n_yates_only <- function(P1, P2, r, alpha, beta){\n\n  Za <- qnorm(1 - alpha/2)\n  Zb <- qnorm(1 - beta)\n\n  # P_M\n  PM <- (P1 + r*P2) / (r + 1)\n\n  # n'\n  nprime <- (\n    (Za * sqrt((r + 1) * PM * (1 - PM)) -\n       Zb * sqrt(r * P1 * (1 - P1) + P2 * (1 - P2))\n    )^2\n  ) / ( r * (P1 - P2)^2 )\n\n  # Corrección de Yates\n  n_yates <- (nprime / 4) *\n    (1 + sqrt(1 + (2 * (r + 1)) / (nprime * r * abs(P2 - P1))))^2\n\n  return(n_yates)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\nalpha <- 0.05\nbeta  <- 0.20\nr     <- 1\n\ngrid$n <- calc_n_yates_only(grid$P1, grid$P2, r, alpha, beta)\n\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Un control por cada caso\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n\n-   Dos controles por cada caso.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n_yates_only <- function(P1, P2, r, alpha, beta){\n\n  Za <- qnorm(1 - alpha/2)\n  Zb <- qnorm(1 - beta)\n\n  # P_M\n  PM <- (P1 + r*P2) / (r + 1)\n\n  # n'\n  nprime <- (\n    (Za * sqrt((r + 1) * PM * (1 - PM)) -\n       Zb * sqrt(r * P1 * (1 - P1) + P2 * (1 - P2))\n    )^2\n  ) / ( r * (P1 - P2)^2 )\n\n  # Corrección de Yates\n  n_yates <- (nprime / 4) *\n    (1 + sqrt(1 + (2 * (r + 1)) / (nprime * r * abs(P2 - P1))))^2\n\n  return(n_yates)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\nalpha <- 0.05\nbeta  <- 0.20\nr     <- 2\n\ngrid$n <- calc_n_yates_only(grid$P1, grid$P2, r, alpha, beta)\n\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Dos controles por cada caso\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n\n-   Tres controles por cada caso.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n_yates_only <- function(P1, P2, r, alpha, beta){\n\n  Za <- qnorm(1 - alpha/2)\n  Zb <- qnorm(1 - beta)\n\n  # P_M\n  PM <- (P1 + r*P2) / (r + 1)\n\n  # n'\n  nprime <- (\n    (Za * sqrt((r + 1) * PM * (1 - PM)) -\n       Zb * sqrt(r * P1 * (1 - P1) + P2 * (1 - P2))\n    )^2\n  ) / ( r * (P1 - P2)^2 )\n\n  # Corrección de Yates\n  n_yates <- (nprime / 4) *\n    (1 + sqrt(1 + (2 * (r + 1)) / (nprime * r * abs(P2 - P1))))^2\n\n  return(n_yates)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\nalpha <- 0.05\nbeta  <- 0.20\nr     <- 3\n\ngrid$n <- calc_n_yates_only(grid$P1, grid$P2, r, alpha, beta)\n\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Tres controles por cada caso\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n:::\n\n## Cuándo usar cada tipo de cálculo de tamaño de muestra {.scrollable}\n\n1.  Estimar la Razón de Odds (OR) con una precisión relativa especificada.\n\n-   Estimar la OR entre consumo de alcohol y cáncer gástrico en una región para generar evidencia local.\n\n-   Estimar la asociación entre exposición a pesticidas y enfermedad de Parkinson con un IC95% estrecho.\n\n2.  Probar que la Razón de Odds (OR) difiere significativamente de 1.\n\n-   Evaluar si un contaminante químico aumenta el riesgo de leucemia infantil.\n\n-   Determinar si un fármaco está asociado a eventos adversos.\n\n## Ejercicio en clase {.scrollable}\n\n1.  En una estudio de cohorte, calcular el tamaño de muestra para lo siguiente.\n\nSupongamos que queremos estudiar la posible asociación de un factor ambiental en la incidencia de una enfermedad respiratoria específica, si deseamos una precisión del $5 \\%$, tenemos dos poblaciones semejantes una no expuesta con $P_2 = 0.1$ y una expuesta con $P_1 = 0.5$\n\n2.  En una estudio de casos y controles, calcular el tamaño de muestra para lo siguiente.\n\nEn una región donde el cólera es un problema grave de salud, se supone que el 10% de la población utilizan agua contaminada. Se desea realizar un estudio para estimar el OR con una precisión relativa del 5% (OR anticipado igual a 2) con un 95% de confianza. ¿Cuál es el tamaño de la muestra en los casos de cólera y en los controles?\n\n## Bibliografía {.smaller}\n\n1.  https://halweb.uc3m.es/esp/Personal/personas/amalonso/esp/bstat-tema6.pdf\n2.  https://halweb.uc3m.es/esp/Personal/personas/amalonso/esp/bstat-tema5.pdf\n3.  https://dsp.facmed.unam.mx/wp-content/uploads/2022/02/Anexo-1C-U-9-Estudios-de-casos-y-controles.-Argimon-J.pdf\n4.  https://mawil.us/wp-content/uploads/2021/10/epidemiologia.pdf\n","srcMarkdownNoYaml":"\n\n## Contenido {.scrollable}\n\n1.  Introducción\n\n2.  ¿ Que es el muestreo en estadística?\n\n3.  Tipo de muestreo\n\n4.  Muestreo en estudios de cohorte\n\n5.  Muestreo en estudios de casos y controles\n\n6.  Ejercicio en clase.\n\n## Introducción {.scrollable}\n\n<p align=\"justify\">\n\nLa importancia del muestreo en epidemiologia es fundamental, ya que permite estudiar poblaciones grandes, de tal manera que al realizar muestreo se puede asegurar estadisticamente este tendra las siguientes caracteristicas.\n\n-   Permite estudiar poblaciones grandes de forma eficiente\n\n-   Hace posible obtener estimaciones válidas y representativas\n\n-   Reduce sesgos\n\n-   Permite medir prevalencia e incidencia\n\n-   Ayuda en la vigilancia epidemiológica\n\n-   Optimiza recursos\n\n-   Permite generalizar los resultados\n\n-   Permite estimar la precisión (error y confianza)\n\nEn resumen el muestreo permite hacer estudios **eficientes, validos y con recursos limitados**\n\n</p>\n\n## ¿Que es el muestreo en estadística?\n\n<p align=\"justify\">\n\nEl muestreo en estadística es el proceso de seleccionar un grupo representativo de una población mas grande para analizarla y en algunos casos realizar inferencia sobre la población. La muestra debe ser finita, manejable y elegida preferentemente aleatoriamente para minimizar sesgos y garantizar fiabilidad en las estimaciones.\n\n</p>\n\n## Tipos de muestro {.scrollable}\n\n1.  Muestreo probabilístico: ( Marco muestral)\n\n    -   Muestreo aleatorio simple: Todos los individuos tienen la misma probabilidad de ser elegidos.\n\n    -   Muestreo sistemático: Se selecciona cada k individuo después de un punto inicial aleatorio.\n\n    -   Muestreo estratificado: Se divide la población en estratos homogéneos. despues se toma una muestra.\n\n    -   Muestreo por conglomerados: La población se divide en grupos (colegios, barrios, empresas, facultades.etc).\n\n    -   Muestreo multietápico: Combinación de varios tipos de muestreo.\n\n2.  Muestreo no probabilístico\n\n    -   Muestreo por conveniencia: Se elige lo disponible.\n\n    -   Muestreo dirigido: Selección de individuos con características específicas.\n\n    -   Muestreo por cuotas: Se fija cuántas personas se necesitan por grupo (edad, sexo, etc.), pero se selecciona de forma no aleatoria.\n\n    -   Muestreo bola de nieve: Un participante refiere a otros.\n\n# Muestreo en estudios de cohorte\n\n## Características del diseño en un estudio de cohortes {.smaller}\n\nEs un estudio observacional y longitudinal que investiga la presencia o ausencia de la exposición de interes, además la ocurrencia del evento se puede determinar de manera prospectiva o retrospectiva.\n\n![](figuras/C1.png){fig-align=\"center\" width=\"41.1cm\"}\n\n# Elección del tamaño muestral\n\n## Contexto para el cálculo de muestras\n\n1.  Si el objetivo es estimar el RR con una precisión relativa especificada.\n2.  Si el objetivo es probar que el RR es estadísticamente diferente de 1.\n3.  Si el objetivo es comparar dos tasas de incidencia.\n\n## Estimar el riesgo relativo con una precisión relativa especificada {.scrollable}\n\na.  Dos de las siguientes proposiciones:\n\n-   Probabilidad anticipada de enfermar en personas expuestas al factor de interés: $P_1$\n\n-   Probabilidad anticipada de enfermar en personas no expuestas al factor de interés: $P_2$\n\n-   Riesgo Relativo anticipado: $RR=P_1 / P_2$\n\nb.  Nivel de confianza: 100(1-α)%\n\nc.  Precisión relativa: ε\n\nSi cumple con lo anterior se puede calcular el tamaño de muestra n.\n\n$$\nn = \\frac{Z_{1-\\alpha/2}^2 \\left[ \\frac{1-P_1}{P_1} + \\frac{1-P_2}{P_2} \\right]}\n{\\ln^2 (1-\\varepsilon)}\n$$\n\n## Aplicación {.scrollable}\n\n::: panel-tabset\n### Ejemplo {.smaller}\n\nSupongamos que queremos estudiar la posible asociación de un factor ambiental en la incidencia de una enfermedad respiratoria específica, si deseamos una precisión del $10 \\%$, tenemos dos poblaciones semejantes una no expuesta con $P_2 = 0.2$ y una expuesta con $P_1 = 0.4$\n\n```{r}\n#| echo: true\nalpha <- 0.05\nP1 <- 0.5\nP2 <- 0.1\nepsilon <- 0.05\n\nn <- (qnorm(1 - alpha/2)^2 * ((1 - P1)/P1 + (1 - P2)/P2)) / (log(1 - epsilon)^2)\nn\n\n```\n\nSe obtiene $1903.28$ para cada grupo.\n\n### Simulación de parámetros {.smaller}\n\nSe realiza la simulación de parámetros donde $\\alpha$ y $\\varepsilon$ son fijos, y $P_1$ y $P_2$ son variables.\n\n```{r, echo=FALSE,warning=TRUE}\n#|echo: false\nlibrary(plotly)\n\ncalc_n <- function(P1, P2, alpha, epsilon) {\n  n <- (qnorm(1 - alpha/2)^2 * ((1 - P1)/P1 + (1 - P2)/P2)) / (log(1 - epsilon)^2)\n return(n)\n}\n\n\ngrafico<-function(alpha,epsilon) {\n  \n# --- RANGOS VARIABLES ---\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\n# --- MATRIZ DE RESULTADOS ---\nz_matrix <- outer(P1_vals, P2_vals,\n                  Vectorize(function(a, b) calc_n(a, b, alpha, epsilon)))\n\n# --- GRAFICO 3D ---\np1<-plot_ly(\n  x = P1_vals,\n  y = P2_vals,\n  z = z_matrix,\n  type = \"surface\",\n  colorscale = \"Viridis\"\n) %>%\n  layout(\n    title = paste(\"P1 vs P2 para epsilon=\",epsilon,\"y alpha=\",alpha),\n    scene = list(\n      xaxis = list(title = \"P1\"),\n      yaxis = list(title = \"P2\"),\n      zaxis = list(title = \"n\")\n    )\n  )\n\nreturn(p1)\n}\n\n```\n\n-   Para $\\alpha=0.05$ y $\\varepsilon=0.1$\n\n```{r, echo=FALSE}\n#|echo: false\n# --- PARAMETROS FIJOS ---\nalpha <- 0.05\nepsilon <- 0.1\n\ngrafico(alpha,epsilon)\n\n```\n\n-   Para $\\alpha=0.05$ y $\\varepsilon=0.3$\n\n```{r, echo=FALSE}\n#|echo: false\n# --- PARAMETROS FIJOS ---\nalpha <- 0.05\nepsilon <- 0.3\n\ngrafico(alpha,epsilon)\n\n```\n\n-   Para $\\alpha=0.05$ y $\\varepsilon=0.6$\n\n```{r, echo=FALSE}\n#|echo: false\n# --- PARAMETROS FIJOS ---\nalpha <- 0.05\nepsilon <- 0.6\n\ngrafico(alpha,epsilon)\n\n```\n\n-   Para $\\alpha=0.05$ y $\\varepsilon=0.9$\n\n```{r, echo=FALSE}\n#|echo: false\n# --- PARAMETROS FIJOS ---\nalpha <- 0.05\nepsilon <- 0.9\n\ngrafico(alpha,epsilon)\n\n```\n:::\n\n## Probar que el RR es estadísticamente diferente de 1 {.scrollable}\n\na.  Prueba de hipótesis: $H_o : RR = 1$ vs $H_a : RR ≠ 1$\n\nb.  Dos de las siguientes propsiciones:\n\n-   Probabilidad anticipada de enfermar en personas expuestas al factor de interés: $P_1$\n\n-   Probabilidad anticipada de enfermar en personas no expuestas al factor de interés: $P_2$\n\n-   Riesgo Relativo anticipado: $RR=P_1 / P_2$\n\nc.  Nivel de confianza: $100(1 − α)\\%$\n\nd.  Potencia del test: $100(1 − β)\\%$\n\ne.  Cantidad de no expuestos por cada expuesto: r\n\nSi cumple con lo anterior se puede calcular el tamaño de muestra n.\n\nSe utiliza la siguiente expresión:\n\n$$\nn' = \\frac{\\left[ Z_{1-\\alpha/2} \\sqrt{(r+1)P_M(1-P_M)} - Z_{1-\\beta} \\sqrt{rP_1(1-P_1) + P_2(1-P_2)} \\right]^2}{r(P_1 - P_2)^2}\n$$\n\ndonde:\n\n$$\nP_M = \\frac{(P_1 + rP_2)}{(r+1)}\n$$\n\nAsimismo, la mayoría de software estadístico, como EpiDat, propone la corrección de Yates para el cálculo del tamaño muestral:\n\n$$\nn = \\frac{n'}{4} \\left[ 1 + \\sqrt{1 + \\frac{2(r+1)}{n' r \\left| P_2 - P_1 \\right|}} \\right]^2\n$$\n\n## Aplicación {.scrollable}\n\n::: panel-tabset\n### Ejemplo {.smaller}\n\nCalcular el tamaño de muestra suponiendo que $P_1 = 0.2$ y $P_2 = 0.1$, $α = 0.05$, $β = 0.2$ y $r = 1$ (un no expuesto por cada expuesto)\n\n```{r}\n#| echo: true\n\ncalc_muestra <- function(P1, P2, r, alpha, power){\n\n  # Z's\n  Za <- qnorm(1 - alpha/2)\n  Zb <- qnorm(1-power)   \n\n  # P_M\n  PM <- (P1 + r*P2) / (r + 1)\n\n  # n'\n  n_prime <- (\n    Za*sqrt((r+1)*PM*(1-PM)) -\n      Zb*sqrt(r*P1*(1-P1) + P2*(1-P2))\n  )^2 / ( r*(P1 - P2)^2 )\n\n  # Corrección de Yates\n  n_yates <- (n_prime/4) *\n    ( 1 + sqrt(1 + 2*(r+1)/(n_prime*r*abs(P2-P1))) )^2\n\n  return( n_yates)\n}\n\n\nres <- calc_muestra(\n  P1 = 0.2,\n  P2 = 0.1,\n  r = 1,\n  alpha = 0.05,\n  power = 0.80\n)\n\nres\n```\n\nEntonces el tamaño de muestra calculado es $n = 219$ en ambos grupos por la correción de yates.\n\n### Simulación de parámetros {.smaller}\n\nSe realiza la simulación de parámetros donde $\\alpha$, $power$ y $r$ son fijos, y $P_1$ y $P_2$ son variables.\n\n```{r, echo=FALSE}\n#|echo: false\n\ngrafico2<-function(r,alpha,power) {\n\n# Secuencias para P1 y P2\nP1_seq <-  seq(0.05, 0.98, by = 0.05)\nP2_seq <-  seq(0.05, 0.98, by = 0.05)\n\n# Crear todas las combinaciones P1-P2\ngrid <- expand.grid(P1 = P1_seq, P2 = P2_seq)\n\n# Eliminar combinaciones donde P1 = P2\ngrid <- subset(grid, P1 != P2)\n\n# Calcular muestra para cada combinación\ngrid$n <- mapply(\n  calc_muestra,\n  P1 = grid$P1,\n  P2 = grid$P2,\n  MoreArgs = list(r = r, alpha = alpha, power = power)\n)\n\n\n\n#  Heatmap\np2<-ggplot(grid, aes(x = P1, y = P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"viridis\") +\n  labs(\n    title = paste(\"P1 vs P2 para r=\",r,\", alpha=\",alpha,\"y power=\",power),\n    x = \"P1\",\n    y = \"P2\",\n    fill = \"n\"\n  ) +\n  theme_minimal(base_size = 14)\n\nreturn(p2)\n  \n}\n\n\n```\n\n-   Para $\\alpha=0.05$,$power=0.8$ y $r=1$\n\n```{r, echo=FALSE}\n#|echo: false\n\n# Valores fijos\nr     <- 1\nalpha <- 0.05\npower <- 0.80\n\ngrafico2(r,alpha,power)\n\n```\n\n-   Para $\\alpha=0.05$,$power=0.8$ y $r=2$\n\n```{r, echo=FALSE}\n#|echo: false\n\n# Valores fijos\nr     <- 2\nalpha <- 0.05\npower <- 0.80\n\ngrafico2(r,alpha,power)\n\n```\n\n-   Para $\\alpha=0.05$,$power=0.8$ y $r=3$\n\n```{r, echo=FALSE}\n#|echo: false\n\n# Valores fijos\nr     <- 3\nalpha <- 0.05\npower <- 0.80\n\ngrafico2(r,alpha,power)\n\n```\n\n-   Para $\\alpha=0.05$,$power=0.8$ y $r=4$\n\n```{r, echo=FALSE}\n#|echo: false\n\n# Valores fijos\nr     <- 4\nalpha <- 0.05\npower <- 0.80\n\ngrafico2(r,alpha,power)\n\n```\n\n-   Para $\\alpha=0.05$,$power=0.8$ y $r=5$\n\n```{r, echo=FALSE}\n#|echo: false\n\n# Valores fijos\nr     <- 5\nalpha <- 0.05\npower <- 0.80\n\ngrafico2(r,alpha,power)\n\n```\n:::\n\n## Comparar dos tasas de incidencia {.scrollable}\n\na.  Hipótesis nula H₀: μ₁ - μ₂ = 0\n\nb.  Valores anticipados de μ₁ y μ₂\n\nc.  Nivel de confianza: 100(1−α)%\n\nd.  Potencia del test: 100(1−β)%\n\ne.  Hipótesis alternativa H₁:\n\n    -   μ₁ − μ₂ \\< 0\\\n    -   μ₁ − μ₂ \\> 0\\\n    -   μ₁ − μ₂ ≠ 0\n\nf.  Duración del estudio: T\n\nBajo este contexto se aplican las siguientes expresiones.\n\n-   Si el estudio no tiene duración fija (o sea los sujetos se siguen durante toda su vida) se utiliza la siguiente fórmula:\n\n    **Para pruebas de una cola:**\n\n    $$n_1 = \\frac{\\left[z_{1-\\alpha}\\sqrt{(1+k)\\mu_m^2} + z_{1-\\beta}\\sqrt{k\\mu_1^2 + \\mu_2^2}\\right]^2}{k(\\mu_1 - \\mu_2)^2}$$\n\n    donde $\\mu_m = (\\mu_1 + \\mu_2)/2$ y $k$ es el cociente de la cantidad de individuos del segundo grupo ($n_2$) entre la cantidad del primer grupo ($n_1$).\n\n    **Para pruebas de dos colas:**\n\n    $$n_1 = \\frac{\\left[z_{1-\\alpha/2}\\sqrt{(1+k)\\mu_m^2} + z_{1-\\beta}\\sqrt{k\\mu_1^2 + \\mu_2^2}\\right]^2}{k(\\mu_1 - \\mu_2)^2}$$\n\n-   Si el estudio termina antes que todos los individuos experimenten el suceso de interés. Los valores de μ deben modificarse de acuerdo a la siguiente fórmula:\n\n    $$f(\\mu) = \\frac{\\mu^3 T}{\\mu T - 1 + \\exp(-\\mu T)}$$\n\n    Notemos que cuando $T$ tiende a infinito entonces $f(\\mu) = \\mu^2$.\n\n    La fórmula apropiada para el tamaño de muestra en pruebas de dos colas es:\n\n    $$n_1 = \\frac{\\left[z_{1-\\alpha/2}\\sqrt{(1+k)f(\\mu_m)} + z_{1-\\beta}\\sqrt{kf(\\mu_1) + f(\\mu_2)}\\right]^2}{k(\\mu_1 - \\mu_2)^2}$$\n\n## Aplicación {.scrollable}\n\n::: panel-tabset\n### Ejemplo {.smaller}\n\nComo parte de un estudio de los efectos a largo plazo del ruido, se diseña un estudio de seguimiento de trabajadores de una industria ruidosa y de una ocupación menos ruidosa. Los sujetos serán seguidos de por vida, y periódicamente serán examinados en cuanto a disfunciones auditivas. Una encuesta previa sugiere una tasa de incidencia anual del 25% en dicha industria. ¿Cuántas personas se deberán seguir si queremos saber que esta tasa difiere del promedio nacional de disfunciones auditivas = 10%, con un nivel de significación del 5% y una potencia del 80%?\n\n```{r}\n#| echo: true\n# Parámetros\nmu1  <- 0.25\nmu2  <- 0.10\nalpha <- 0.05\nbeta  <- 0.20\n\n# k = n2 / n1  (modifícalo según tu diseño)\nk <- 1   #  n2 = n1\n\n# Cuantiles Z\nz_alpha_2 <- qnorm(1 - alpha/2) \nz_beta    <- qnorm(1 - beta)      \n\n\nmu_m <- (mu1 + mu2) / 2\n\n# Términos de la fórmula\nterm1 <- z_alpha_2 * sqrt((1 + k) * mu_m^2)\nterm2 <- z_beta    * sqrt(k * mu1^2 + mu2^2)\n\n# Fórmula final\nn1 <- (term1 + term2)^2 / (k * (mu1 - mu2)^2)\n\n\n# Resultados\ncat(\"n1 =\", n1, \"\\n\")\n\n\n```\n\nSe tiene que para cada grupo se requeririan 23 personas.\n\nAhora si consideramos que la duración del estudio es de 5 años,tenemos los siguiente.\n\n```{r}\n#| echo: true\n\nt<-5\n\nfu_m<- (mu_m^3 * t)/(mu_m*t-1+exp(-mu_m*t))\n\nfu_1<- (mu1^3 * t)/(mu1*t-1+exp(-mu1*t))\nfu_2<- (mu2^3 * t)/(mu2*t-1+exp(-mu2*t))\n\n# Términos de la fórmula\ntermf1 <- z_alpha_2 * sqrt((1 + k) *fu_m )\ntermf2 <- z_beta    * sqrt(k * fu_1+ fu_2)\n\n# Fórmula final\nnf1 <- (termf1 + termf2)^2 / (k * (mu1 - mu2)^2)\nnf1\n\n\n```\n\nSe tiene que para cada grupo se requeririan 65 personas.\n\n### Simulación caso seguimiento de por vida {.smaller}\n\n-   Si $n_2=n_1$ es decir $k=1$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n1 <- function(mu1, mu2) {\n  alpha <- 0.05\n  beta  <- 0.20\n  k     <- 1\n  \n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n  \n  mu_m <- (mu1 + mu2) / 2\n  \n  term1 <- z_alpha_2 * sqrt((1 + k) * mu_m^2)\n  term2 <- z_beta    * sqrt(k * mu1^2 + mu2^2)\n  \n  n1 <- (term1 + term2)^2 / (k * (mu1 - mu2)^2)\n  return(n1)\n}\n\n\n  \nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n\ngrid$n1 <- mapply(calc_n1, grid$mu1, grid$mu2)\n\n\n\nggplot(grid, aes(x = mu1, y = mu2, fill = n1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"viridis\") +\n  labs(\n    title = \"Tamaño muestral n1 donde k=1\",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"n1\"\n  ) +\n  theme_minimal(base_size = 14)\n\n\n```\n\n-   Si $n_2>n_1$ es decir $k>1$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n1 <- function(mu1, mu2) {\n  alpha <- 0.05\n  beta  <- 0.20\n  k     <- 3\n  \n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n  \n  mu_m <- (mu1 + mu2) / 2\n  \n  term1 <- z_alpha_2 * sqrt((1 + k) * mu_m^2)\n  term2 <- z_beta    * sqrt(k * mu1^2 + mu2^2)\n  \n  n1 <- (term1 + term2)^2 / (k * (mu1 - mu2)^2)\n  return(n1)\n}\n\n\n  \nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n\ngrid$n1 <- mapply(calc_n1, grid$mu1, grid$mu2)\n\n\n\nggplot(grid, aes(x = mu1, y = mu2, fill = n1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"viridis\") +\n  labs(\n    title = \"Tamaño muestral n1 donde k=3\",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"n1\"\n  ) +\n  theme_minimal(base_size = 14)\n\n\n```\n\n-   Si $n_2<n_1$ es decir $k<1$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n1 <- function(mu1, mu2) {\n  alpha <- 0.05\n  beta  <- 0.20\n  k     <- 0.1\n  \n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n  \n  mu_m <- (mu1 + mu2) / 2\n  \n  term1 <- z_alpha_2 * sqrt((1 + k) * mu_m^2)\n  term2 <- z_beta    * sqrt(k * mu1^2 + mu2^2)\n  \n  n1 <- (term1 + term2)^2 / (k * (mu1 - mu2)^2)\n  return(n1)\n}\n\n\n  \nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n\ngrid$n1 <- mapply(calc_n1, grid$mu1, grid$mu2)\n\n\n\nggplot(grid, aes(x = mu1, y = mu2, fill = n1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"viridis\") +\n  labs(\n    title = \"Tamaño muestral n1 donde k=0.1\",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"n1\"\n  ) +\n  theme_minimal(base_size = 14)\n\n\n```\n\n### Simulación caso T {.smaller}\n\n-   Si $t=5$ y $k=1$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_nf1 <- function(mu1, mu2){\n\n  # Parámetros fijos\n  alpha <- 0.05\n  beta  <- 0.20\n  t     <- 5\n  k     <- 1\n\n  # Cuantiles\n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n\n  # mu_m\n  mu_m <- (mu1 + mu2) / 2\n\n  # Funciones fu\n  fu_m <- (mu_m^3 * t) / (mu_m * t - 1 + exp(-mu_m * t))\n  fu_1 <- (mu1^3 * t) / (mu1 * t - 1 + exp(-mu1 * t))\n  fu_2 <- (mu2^3 * t) / (mu2 * t - 1 + exp(-mu2 * t))\n\n  # Términos\n  termf1 <- z_alpha_2 * sqrt((1 + k) * fu_m)\n  termf2 <- z_beta    * sqrt(k * fu_1 + fu_2)\n\n  # Fórmula final\n  nf1 <- (termf1 + termf2)^2 / (k * (mu1 - mu2)^2)\n\n  return(nf1)\n}\n\n\n# -----------------------------------------\n# Crear rejilla de valores mu1 y mu2\n# -----------------------------------------\nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n# Evitar combinación inválida mu1 == mu2\ngrid <- subset(grid, mu1 != mu2)\n\n# Calcular valores nf1\ngrid$nf1 <- mapply(calc_nf1, grid$mu1, grid$mu2)\n\n\n# -----------------------------------------\n# Heatmap con ggplot2\n# -----------------------------------------\nlibrary(ggplot2)\n\nggplot(grid, aes(x = mu1, y = mu2, fill = nf1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"plasma\", trans = \"log\", breaks = c(10, 100, 1000, 5000)) +\n  labs(\n    title = \"Tamaño muestral para t=5 y k=1 \",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"nf1\"\n  ) +\n  theme_minimal(base_size = 14) + \n  theme(\n    plot.title = element_text(face = \"bold\", size = 18),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n\n```\n\n-   Si $t=5$ y $k=3$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_nf1 <- function(mu1, mu2){\n\n  # Parámetros fijos\n  alpha <- 0.05\n  beta  <- 0.20\n  t     <- 5\n  k     <- 3\n\n  # Cuantiles\n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n\n  # mu_m\n  mu_m <- (mu1 + mu2) / 2\n\n  # Funciones fu\n  fu_m <- (mu_m^3 * t) / (mu_m * t - 1 + exp(-mu_m * t))\n  fu_1 <- (mu1^3 * t) / (mu1 * t - 1 + exp(-mu1 * t))\n  fu_2 <- (mu2^3 * t) / (mu2 * t - 1 + exp(-mu2 * t))\n\n  # Términos\n  termf1 <- z_alpha_2 * sqrt((1 + k) * fu_m)\n  termf2 <- z_beta    * sqrt(k * fu_1 + fu_2)\n\n  # Fórmula final\n  nf1 <- (termf1 + termf2)^2 / (k * (mu1 - mu2)^2)\n\n  return(nf1)\n}\n\n\n# -----------------------------------------\n# Crear rejilla de valores mu1 y mu2\n# -----------------------------------------\nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n# Evitar combinación inválida mu1 == mu2\ngrid <- subset(grid, mu1 != mu2)\n\n# Calcular valores nf1\ngrid$nf1 <- mapply(calc_nf1, grid$mu1, grid$mu2)\n\n\n# -----------------------------------------\n# Heatmap con ggplot2\n# -----------------------------------------\nlibrary(ggplot2)\n\nggplot(grid, aes(x = mu1, y = mu2, fill = nf1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"plasma\", trans = \"log\", breaks = c(10, 100, 1000, 5000)) +\n  labs(\n    title = \"Tamaño muestral para t=5 y k=3 \",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"nf1\"\n  ) +\n  theme_minimal(base_size = 14) + \n  theme(\n    plot.title = element_text(face = \"bold\", size = 18),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n\n```\n\n-   Si $t=5$ y $k=0.1$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_nf1 <- function(mu1, mu2){\n\n  # Parámetros fijos\n  alpha <- 0.05\n  beta  <- 0.20\n  t     <- 5\n  k     <- 0.1\n\n  # Cuantiles\n  z_alpha_2 <- qnorm(1 - alpha/2)\n  z_beta    <- qnorm(1 - beta)\n\n  # mu_m\n  mu_m <- (mu1 + mu2) / 2\n\n  # Funciones fu\n  fu_m <- (mu_m^3 * t) / (mu_m * t - 1 + exp(-mu_m * t))\n  fu_1 <- (mu1^3 * t) / (mu1 * t - 1 + exp(-mu1 * t))\n  fu_2 <- (mu2^3 * t) / (mu2 * t - 1 + exp(-mu2 * t))\n\n  # Términos\n  termf1 <- z_alpha_2 * sqrt((1 + k) * fu_m)\n  termf2 <- z_beta    * sqrt(k * fu_1 + fu_2)\n\n  # Fórmula final\n  nf1 <- (termf1 + termf2)^2 / (k * (mu1 - mu2)^2)\n\n  return(nf1)\n}\n\n\n# -----------------------------------------\n# Crear rejilla de valores mu1 y mu2\n# -----------------------------------------\nmu1_vals <- seq(0.05, 0.98, by = 0.05)\nmu2_vals <- seq(0.05, 0.98, by = 0.05)\n\ngrid <- expand.grid(mu1 = mu1_vals, mu2 = mu2_vals)\n\n# Evitar combinación inválida mu1 == mu2\ngrid <- subset(grid, mu1 != mu2)\n\n# Calcular valores nf1\ngrid$nf1 <- mapply(calc_nf1, grid$mu1, grid$mu2)\n\n\n\nlibrary(ggplot2)\n\nggplot(grid, aes(x = mu1, y = mu2, fill = nf1)) +\n  geom_tile() +\n  scale_fill_viridis_c(option = \"plasma\", trans = \"log\", breaks = c(10, 100, 1000, 5000)) +\n  labs(\n    title = \"Tamaño muestral para t=5 y k=0.1 \",\n    x = \"mu1\",\n    y = \"mu2\",\n    fill = \"nf1\"\n  ) +\n  theme_minimal(base_size = 14) + \n  theme(\n    plot.title = element_text(face = \"bold\", size = 18),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n\n```\n:::\n\n## Cuándo usar cada tipo de cálculo de tamaño de muestra {.scrollable}\n\n1.  Estimar el RR con una precisión relativa especificada,basicamente estimar un riesgo relativo (RR) y que el intervalo de confianza tenga una precisión predeterminada.\n\n-   Estudios donde ya se sabe que existe asociación, entonces se quiere una medición precisa.\n-   Estudios de cohorte prospectivos que buscan describir la magnitud del riesgo.\n\n2.  Probar que el RR es estadísticamente diferente de 1. Se busca demostrar una diferencia real\n\n-   Evaluar si un medicamento incrementa o reduce el riesgo de un desenlace.\n-   Estudios prospectivos en ocupacional donde se quiere probar si una exposición es peligrosa.\n\n3.  Comparar dos tasas de incidencia.\n\n-   Investigaciones sobre enfermedades crónicas con períodos largos.\n-   Estudios donde el desenlace es raro, pero se acumula persona-tiempo.\n\n# Muestreo en estudios de casos y controles\n\n## Características del diseño de casos y controles {.smaller}\n\nLos estudios de casos y controles son diseños observacionales, analíticos y retrospectivos.\n\n![](figuras/CC1.png){fig-align=\"center\"}\n\n# Elección del tamaño muestral\n\n## Contexto para el cálculo de muestras\n\n1.  Estimar la Razón de Odds (OR) con una precisión relativa especificada.\n\n2.  Probar que la Razón de Odds (OR) difiere significativamente de 1.\n\n## Estimar la Razón de Odds (OR) con una precisión relativa especificada {.scrollable}\n\nSe debe tener lo siguiente:\n\na.  Dos de los siguientes elementos:\n\n-   **Probabilidad anticipada de la exposición al factor en individuos enfermos:**\\\n    $P_1 = \\frac{a}{a + b}$\n\n-   **Probabilidad anticipada de la exposición en individuos sanos:**\\\n    $P_2 = \\frac{c}{c + d}$\n\n-   **Razón de Odds anticipado:**\\\n    $OR=\\frac{P_1/(1-P_1)}{P_2/(1-P_2)}$\n\nb.  Nivel de confianza: $100(1-\\alpha)\\%$\n\nc.  Precisión relativa: $\\varepsilon$\n\nSe utiliza en este caso la siguiente fórmula para obtener el tamaño muestral:\n\n$$\nn = Z_{1-\\alpha/2}^2 \\, \\frac{ \\frac{1}{P_1(1-P_1)} + \\frac{1}{P_2(1-P_2)} }{ \\ln^2(1-\\varepsilon) }\n$$\n\n## Aplicación {.scrollable}\n\n::: panel-tabset\n### Ejemplo {.smaller}\n\nEn una región donde el cólera es un problema grave de salud, se supone que el 30% de la población utilizan agua contaminada. Se desea realizar un estudio para estimar el OR con una precisión relativa del 25% (OR anticipado igual a 2) con un 95% de confianza. ¿Cuál es el tamaño de la muestra en los casos de cólera y en los controles?\n\nTenemos que $P_2 = 0.3$, $OR = 2$,$\\varepsilon = 0.25$ y $\\alpha = 0.05$.\n\nCalculamos primero $P_1$ mediante:\n\n$$\nP_1 = \\frac{P_2}{(1 - P_2)/OR + P_2}\n     = \\frac{0.3}{0.7/2 + 0.3}\n     \\approx 0.46\n$$\n\n```{r}\n#| echo: true\nn <- function(P1, P2, alpha, eps){\n\n  Za <- qnorm(1 - alpha/2)\n\n  n <- Za^2 * ( 1/(P1*(1-P1)) + 1/(P2*(1-P2)) ) / ( log(1 - eps)^2 )\n\n  return(n)\n}\n\nn(P1 = 0.18, P2 = 0.1, alpha = 0.05, eps =0.05 )\n```\n\n### Simulación {.smaller}\n\n-   Para una precisión relativa de $10 \\%$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n <- function(P1, P2, alpha, eps){\n\n  Za <- qnorm(1 - alpha/2)\n\n  n <- Za^2 * ( 1/(P1*(1-P1)) + 1/(P2*(1-P2)) ) /\n       ( log(1 - eps)^2 )\n\n  return(n)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\n\nalpha <- 0.05\neps   <- 0.10\n\ngrid$n <- calc_n(grid$P1, grid$P2, alpha, eps)\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Tamaño de muestra precisión relativa de 10 %\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n\n-   Para una precisión relativa de $30 \\%$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n <- function(P1, P2, alpha, eps){\n\n  Za <- qnorm(1 - alpha/2)\n\n  n <- Za^2 * ( 1/(P1*(1-P1)) + 1/(P2*(1-P2)) ) /\n       ( log(1 - eps)^2 )\n\n  return(n)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\n\nalpha <- 0.05\neps   <- 0.30\n\ngrid$n <- calc_n(grid$P1, grid$P2, alpha, eps)\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Tamaño de muestra precisión relativa de 30 %\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n\n-   Para una precisión relativa de $60 \\%$.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n <- function(P1, P2, alpha, eps){\n\n  Za <- qnorm(1 - alpha/2)\n\n  n <- Za^2 * ( 1/(P1*(1-P1)) + 1/(P2*(1-P2)) ) /\n       ( log(1 - eps)^2 )\n\n  return(n)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\n\nalpha <- 0.05\neps   <- 0.60\n\ngrid$n <- calc_n(grid$P1, grid$P2, alpha, eps)\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Tamaño de muestra precisión relativa de 60 %\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n:::\n\n## Probar que la Razón de Odds (OR) difiere significativamente de 1 {.scrollable}\n\na.  Hipótesis nula: **H₀:** $OR = 1$\n\nb.  Dos de los siguientes elementos:\n\n-   Probabilidad anticipada de la exposición al factor en individuos enfermos $P_1$\n-   Probabilidad anticipada de la exposición en individuos sanos $P_2$\n-   Razón de Odds anticipado $OR_a$\n\nc.  Nivel de confianza: $100(1-\\alpha)\\%$\n\nd.  Potencia del test: $100(1-\\beta)\\%$\n\ne.  Hipótesis alternativa: **Hₐ:** $OR_a \\ne 1$\n\nSe utiliza en este caso la siguiente fórmula:\n\n$$\nn' =\n\\frac{\n\\left[\nZ_{1-\\alpha/2}\\,\\sqrt{(r+1)P_M(1-P_M)}\n\\;-\\;\nZ_{1-\\beta}\\,\\sqrt{rP_1(1-P_1) + P_2(1-P_2)}\n\\right]^2\n}{\nr(P_1 - P_2)^2\n}\n$$\n\ndonde:\n\n$$\nP_M = \\frac{P_1 + rP_2}{r + 1}\n$$\n\nCon la *corrección de Yates* para el cálculo del tamaño muestral:\n\n$$\nn = \n\\frac{n'}{4}\n\\left[\n1\n+\n\\sqrt{\n1 + \n\\frac{2(r+1)}{\nn'r\\,|P_2 - P_1|\n}\n}\n\\right]^2\n$$\n\n## Aplicación {.scrollable}\n\n::: panel-tabset\n### Ejemplo {.smaller}\n\nCalcular del tamaño muestral suponiendo que \\$P2 = 0.1 \\$y $OR = 2.0$, $α = 0.05$, $β = 0.8$ y $r = 1$ (un control por cada caso).\n\n```{r}\n#| echo: true\n\ncalc_nprime <- function(P1, P2, r, alpha, beta){\n\n  # Z de alfa y beta\n  Za <- qnorm(1 - alpha/2)\n  Zb <- qnorm(1 - beta)\n\n  # P_M\n  PM <- (P1 + r*P2) / (r + 1)\n\n  # n'\n  nprime <- (\n    (Za * sqrt((r + 1) * PM * (1 - PM)) -\n       Zb * sqrt(r * P1 * (1 - P1) + P2 * (1 - P2))\n    )^2\n  ) /\n    ( r * (P1 - P2)^2 )\n\n  return(nprime)\n}\n\n\ncalc_n_yates <- function(nprime, P1, P2, r){\n\n  n <- (nprime / 4) *\n    ( 1 + sqrt(1 + (2 * (r + 1)) / (nprime * r * abs(P2 - P1))) )^2\n\n  return(n)\n}\n\ncalc_n_full <- function(P1, P2, r, alpha, beta){\n\n  nprime <- calc_nprime(P1, P2, r, alpha, beta)\n  n_yates <- calc_n_yates(nprime, P1, P2, r)\n\n  return(list(nprime = nprime, n_yates = n_yates))\n}\n\ncalc_n_full(P1 = 0.1818, P2 = 0.1, r = 1, alpha = 0.05, beta = 0.80)\n\n```\n\n### Simulación {.smaller}\n\n-   Un control por cada caso.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n_yates_only <- function(P1, P2, r, alpha, beta){\n\n  Za <- qnorm(1 - alpha/2)\n  Zb <- qnorm(1 - beta)\n\n  # P_M\n  PM <- (P1 + r*P2) / (r + 1)\n\n  # n'\n  nprime <- (\n    (Za * sqrt((r + 1) * PM * (1 - PM)) -\n       Zb * sqrt(r * P1 * (1 - P1) + P2 * (1 - P2))\n    )^2\n  ) / ( r * (P1 - P2)^2 )\n\n  # Corrección de Yates\n  n_yates <- (nprime / 4) *\n    (1 + sqrt(1 + (2 * (r + 1)) / (nprime * r * abs(P2 - P1))))^2\n\n  return(n_yates)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\nalpha <- 0.05\nbeta  <- 0.20\nr     <- 1\n\ngrid$n <- calc_n_yates_only(grid$P1, grid$P2, r, alpha, beta)\n\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Un control por cada caso\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n\n-   Dos controles por cada caso.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n_yates_only <- function(P1, P2, r, alpha, beta){\n\n  Za <- qnorm(1 - alpha/2)\n  Zb <- qnorm(1 - beta)\n\n  # P_M\n  PM <- (P1 + r*P2) / (r + 1)\n\n  # n'\n  nprime <- (\n    (Za * sqrt((r + 1) * PM * (1 - PM)) -\n       Zb * sqrt(r * P1 * (1 - P1) + P2 * (1 - P2))\n    )^2\n  ) / ( r * (P1 - P2)^2 )\n\n  # Corrección de Yates\n  n_yates <- (nprime / 4) *\n    (1 + sqrt(1 + (2 * (r + 1)) / (nprime * r * abs(P2 - P1))))^2\n\n  return(n_yates)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\nalpha <- 0.05\nbeta  <- 0.20\nr     <- 2\n\ngrid$n <- calc_n_yates_only(grid$P1, grid$P2, r, alpha, beta)\n\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Dos controles por cada caso\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n\n-   Tres controles por cada caso.\n\n```{r, echo=FALSE}\n#|echo: false\n\ncalc_n_yates_only <- function(P1, P2, r, alpha, beta){\n\n  Za <- qnorm(1 - alpha/2)\n  Zb <- qnorm(1 - beta)\n\n  # P_M\n  PM <- (P1 + r*P2) / (r + 1)\n\n  # n'\n  nprime <- (\n    (Za * sqrt((r + 1) * PM * (1 - PM)) -\n       Zb * sqrt(r * P1 * (1 - P1) + P2 * (1 - P2))\n    )^2\n  ) / ( r * (P1 - P2)^2 )\n\n  # Corrección de Yates\n  n_yates <- (nprime / 4) *\n    (1 + sqrt(1 + (2 * (r + 1)) / (nprime * r * abs(P2 - P1))))^2\n\n  return(n_yates)\n}\n\nP1_vals <- seq(0.05, 0.95, by = 0.05)\nP2_vals <- seq(0.05, 0.95, by = 0.05)\n\ngrid <- expand.grid(P1 = P1_vals, P2 = P2_vals)\n\nalpha <- 0.05\nbeta  <- 0.20\nr     <- 3\n\ngrid$n <- calc_n_yates_only(grid$P1, grid$P2, r, alpha, beta)\n\n\n\nggplot(grid, aes(P1, P2, fill = n)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(title = \"Tres controles por cada caso\",\n       fill = \"n\") +\n  theme_minimal()\n\n```\n:::\n\n## Cuándo usar cada tipo de cálculo de tamaño de muestra {.scrollable}\n\n1.  Estimar la Razón de Odds (OR) con una precisión relativa especificada.\n\n-   Estimar la OR entre consumo de alcohol y cáncer gástrico en una región para generar evidencia local.\n\n-   Estimar la asociación entre exposición a pesticidas y enfermedad de Parkinson con un IC95% estrecho.\n\n2.  Probar que la Razón de Odds (OR) difiere significativamente de 1.\n\n-   Evaluar si un contaminante químico aumenta el riesgo de leucemia infantil.\n\n-   Determinar si un fármaco está asociado a eventos adversos.\n\n## Ejercicio en clase {.scrollable}\n\n1.  En una estudio de cohorte, calcular el tamaño de muestra para lo siguiente.\n\nSupongamos que queremos estudiar la posible asociación de un factor ambiental en la incidencia de una enfermedad respiratoria específica, si deseamos una precisión del $5 \\%$, tenemos dos poblaciones semejantes una no expuesta con $P_2 = 0.1$ y una expuesta con $P_1 = 0.5$\n\n2.  En una estudio de casos y controles, calcular el tamaño de muestra para lo siguiente.\n\nEn una región donde el cólera es un problema grave de salud, se supone que el 10% de la población utilizan agua contaminada. Se desea realizar un estudio para estimar el OR con una precisión relativa del 5% (OR anticipado igual a 2) con un 95% de confianza. ¿Cuál es el tamaño de la muestra en los casos de cólera y en los controles?\n\n## Bibliografía {.smaller}\n\n1.  https://halweb.uc3m.es/esp/Personal/personas/amalonso/esp/bstat-tema6.pdf\n2.  https://halweb.uc3m.es/esp/Personal/personas/amalonso/esp/bstat-tema5.pdf\n3.  https://dsp.facmed.unam.mx/wp-content/uploads/2022/02/Anexo-1C-U-9-Estudios-de-casos-y-controles.-Argimon-J.pdf\n4.  https://mawil.us/wp-content/uploads/2021/10/epidemiologia.pdf\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Muestreo.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.9.12","editor":"visual","theme":["cosmo","brand"],"title":"Muestreo para estudios de cohorte y casos y controles","author":"Cesar Fabian Tiguaque Castellanos"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}